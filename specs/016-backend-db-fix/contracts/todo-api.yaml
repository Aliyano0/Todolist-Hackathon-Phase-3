# API Contract: Todo Operations with Priority and Category

## Overview
This document defines the API contract for todo operations in the enhanced todo application, including the new priority and category features.

## Base URL
`http://localhost:8000/api`

## Authentication
All endpoints require a valid JWT token in the Authorization header:
```
Authorization: Bearer {jwt_token}
```

## Endpoints

### Get All Todos
```
GET /tasks
```

#### Request
Headers:
```
Authorization: Bearer {jwt_token}
```

#### Response
Status: `200 OK`

Body:
```json
{
  "tasks": [
    {
      "id": 1,
      "title": "Sample task",
      "description": "Description of the task",
      "completed": false,
      "priority": "high",
      "category": "work",
      "created_at": "2026-02-02T10:00:00Z",
      "updated_at": "2026-02-02T10:00:00Z"
    }
  ]
}
```

### Create Todo
```
POST /tasks
```

#### Request
Headers:
```
Authorization: Bearer {jwt_token}
Content-Type: application/json
```

Body:
```json
{
  "title": "New task",
  "description": "Description of the new task",
  "priority": "medium",
  "category": "personal"
}
```

#### Response
Status: `201 Created`

Body:
```json
{
  "id": 1,
  "title": "New task",
  "description": "Description of the new task",
  "completed": false,
  "priority": "medium",
  "category": "personal",
  "created_at": "2026-02-02T10:00:00Z",
  "updated_at": "2026-02-02T10:00:00Z"
}
```

### Update Todo
```
PUT /tasks/{id}
```

#### Request
Path Parameters:
- `id` (integer): The ID of the todo item

Headers:
```
Authorization: Bearer {jwt_token}
Content-Type: application/json
```

Body:
```json
{
  "title": "Updated task title",
  "description": "Updated description",
  "completed": true,
  "priority": "high",
  "category": "work"
}
```

#### Response
Status: `200 OK`

Body:
```json
{
  "id": 1,
  "title": "Updated task title",
  "description": "Updated description",
  "completed": true,
  "priority": "high",
  "category": "work",
  "created_at": "2026-02-02T10:00:00Z",
  "updated_at": "2026-02-02T10:00:00Z"
}
```

### Toggle Todo Completion
```
PATCH /tasks/{id}/toggle-complete
```

#### Request
Path Parameters:
- `id` (integer): The ID of the todo item

Headers:
```
Authorization: Bearer {jwt_token}
```

#### Response
Status: `200 OK`

Body:
```json
{
  "id": 1,
  "completed": true
}
```

### Delete Todo
```
DELETE /tasks/{id}
```

#### Request
Path Parameters:
- `id` (integer): The ID of the todo item

Headers:
```
Authorization: Bearer {jwt_token}
```

#### Response
Status: `204 No Content`

## Error Responses
All endpoints may return the following error responses:

### 400 Bad Request
```json
{
  "detail": "Invalid request parameters or body"
}
```

### 401 Unauthorized
```json
{
  "detail": "Authentication required"
}
```

### 404 Not Found
```json
{
  "detail": "Task not found"
}
```

### 500 Internal Server Error
```json
{
  "detail": "Internal server error occurred"
}
```

## Data Validation
- `title` is required and must be between 1-255 characters
- `priority` must be one of: 'high', 'medium', 'low'
- `category` is required and must be between 1-50 characters
- `completed` is a boolean value (defaults to false)
- `description` is optional and can be up to 1000 characters